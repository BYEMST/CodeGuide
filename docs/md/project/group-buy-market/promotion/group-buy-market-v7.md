# 又完结一个新项目，toc业务、核心场景！

---
title: 第3阶段开发完成，总结复盘
lock: no
---

# 拼团交易平台逆向流程启动

作者：小傅哥
<br/>博客：[https://bugstack.cn](https://bugstack.cn)

> 沉淀、分享、成长，让自己和他人都能有所收获！😄

大家好，我是技术UP主小傅哥。

**耗时9个月制作，48节课程，微服务分布式架构**，`前后端 + DevOps + AI MCP（场景运用）`，全栈式编程 + 全程视频 + 全套的技术小册，手把手👨🏻‍💻教学，终于完结啦！🎉

<div align="center">
    <img src="https://bugstack.cn/images/article/project/chatgpt/chatgpt-extra-230905-01.png" width="150px">
</div>

**讲道理，做项目，就得做公司里真实有的业务。**

我在非常多的互联网业务应用中，都看到过这样一种产品形态，它就是**拼团交易营销场景**，如；`拼多多/京东购物🛒`、`滴滴拼券🧧`、`腾讯开团抢购服务器☁️`、`美团团购☕️`等等，都是以拼团方式增强交易单量的业务场景。所以，如果想面试互联网公司，还是要优先考虑做一些这样的真实场景业务，这样才能和面试官有东西可以讲，而不是什么都没的聊o(╥﹏╥)o。

此套项目，小傅哥已提供了对应的`简历模板`、`面试问题（一直梳理中）`，还有 AI MCP 场景的加入，通过 AI MCP 对接 ELK + 普罗米修斯监控，Ai Agent 智能化分析系统的日志和运行情况。

**本项目，和你之前学习过的一些项目最大的区别，就是！这是真实的业务，全核心流程覆盖，有非常好的架构和编码设计。这块学习后，进入公司完全可以跟着大家一起做需求，而不是瑟瑟发抖的不知道自己要做啥！**

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250803-04.png" width="650px">
</div>

> 文末有加入学习方式，提供全套的课程代码、文档、视频，此外还有额外的16个实战项目一起获取！

## 一、能学到啥

该项目是互联网toc场景的核心业务流程，以真实业务作为背景，实际可上线，可运行为目标，进行系统的需求分析、架构设计、功能实现，过程涵盖设计模式的运用，解决复杂场景问题。让大家感受到，🐂牛逼的代码，从来不是一顿写CRUD！

- 【前端】以 Ai Agent 设计前端 UI，包括 HTML、Div、CSS 等前端编程技术。
- 【前端】掌握 fetch 方式对后端接口的调用，处理相关的逻辑数据。
- 【后端】熟练搭建项目工程，学习工程分层结构概率和设计思路。掌握更多的六边形、洋葱、整洁架构。`提高简历技术亮点`
- 【后端】熟练掌握 Spring、SpringBoot、MyBatis 等开发框架技术，并对框架源码所提供的扩展接口具备运用能力。
- 【后端】熟练使用 SpringCloud 核心微服务分布式技术栈，包括：Fegin、Sentinel、Nacos、熔断、限流、降级等。`先做功能，后面逐步添加。`
- 【后端】熟练使用大厂中常用的设计模式手段和设计原则技术，对各类场景的方案设计和落地能力，深度提高自身编码思维和开发技术能力。
- 【后端】深度学习复杂场景的架构设计、编程思维，如果处理系统功能的边界和上下文的维护。—— 这些东西一定是从实践中才能学习到的。
- 【后端】熟练使用 Mock 单测工具、JMeter 压测工具，增强代码交付质量。
- 【后端】熟练掌握异常、枚举、错误码的定义和使用，并学习到如何合理打印服务日志，便于问题排查。
- 【后端】以通用场景设计为目的，提取共性逻辑为通用的设计框架，涵盖；动态配置、设计模式（规则树、责任链）、限流。
- 【运维】熟练使用 Docker 在本地和服务端的配置和部署应用，以及在本地构建前后端镜像。
- 【运维】熟练掌握 Git、GitCode，对工程代码的管理，推送、拉取、切换分支、合并代码等操作。
- 【运维】熟练使用 Nginx 配置转发服务，并能申请ssl配置https服务。
- 【运维】熟练使用 Grafana 监控系统 + AI MCP，对系统的 JVM、磁盘、Tomcat、应用(QPS、响应时间、调用量)完整监控。

此外，小傅哥已对全过程都做了需求的分析、功能的设计、编码的精细化处理，让你吃上细糠！也通过这种方式，真正的把你的技术储备整起来，以后进入到公司都是嘎嘎强的选手！

## 二、运行展示

整个拼团交易的流程非常细腻，包括了，一套小型支付 + 拼团营销平台的完整对接，涵盖；`验签`、`扫码/无痕登录`、`试算`、`锁单`、`支付+结算`、`退单+退单`的完整链路流程。如图；

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-3-8-03.png" width="750px">
</div>

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-3-8-04.png" width="750px">
</div>

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-3-8-05.png" width="750px">
</div>

前端页面体现了全部核心流程，看着前端不是太多，但后端支撑整套系统了，写了**1.38万行代码**！

## 三、简历模板

注意：🙅🏻‍ 不要直接复制粘贴简历模板内容！视频提供了 DeepSeek AI 方式编写简历，可以参考。

- **项目名称**：`拼团营销服务系统`、`交易营销场景 - 拼团系统`、`营销拼团交易平台`、`仿拼多多/腾讯/京东，拼团玩法系统（以大厂项目为背书）`、`拼团外卖平台系统（结合其他项目一起组合）` - 参考以上方式编写自己的项目名称，尤其拼团还是一个微服务，可以和很多其他系统组合。

- **项目架构**：`微服务设计`、`分布式架构`、`DDD 领域驱动设计 + 六边形分层架构实现`、`前后端分离技术`

- **核心技术**：SpringBoot、MyBatis、MySQL、Guava、Redis、RabbitMQ、动态配置中心（DCC）、普罗米修斯监控、Docker等 - 如果学习了其他技术栈也可以补充。

- **项目描述**：

  - 方式1（以学习视角介绍）：本项目参考`拼多多`交易购物拼团场景，调研中大厂相关营销业务场景和技术架构方案，设计实现了本套拼团营销服务系统，支持各类营销优惠（直减、折扣、N元购）。该系统以面向对象开发，运用 DDD 拆分领域边界，使用设计模式设计服务功能。提高系统的扩展性和可维护性。
  - 方式2（以提供服务介绍）：该项目以`拉动/促进/提高`（小型支付商城/外卖点餐/购票出行/...）交易单量为目标，通过设计拼团优惠组队下单为手段，达到增强用户自传播分享私域提高整个交易GMV的结果。三段式描述，`...目标，...手段，...结果`
  - 方式3（以实际场景介绍）：该项目是以促进Xxx公司Xxx场景的核心营销优惠玩法系统，围绕公司的xxx、yyy、zzz等全部交易业务，设计通用的拼团优惠锁单和组队结算回调服务。此系统分布式架构设计，可支撑单机压测量 xxx tps，tp99 xxx 的数据指标，有效的满足公司的全量的业务场景接入使用。

- **核心方案**：

  - **架构设计**，以 DDD 领域驱动设计，四色建模方式，按照系统功能流程，拆解服务边界。包括；活动域、标签域、交易域。

  - **设计模式**，设计并提炼通用的`责任链`、`规则树`模型框架，解决领域场景中多处，需要使用设计模式解耦复杂流程链路的调度（避免过多的if...else判断）。鉴于多处场景的责任链使用，模块框架设计责任链为执行和链路分离组装，便于工厂可以组合出各类执行责任链，不被不同的链路管理影响（以往的责任链，一般是单例的，会被影响）。

  - **规则过滤**；

    - （举例）以拼团试算场景举例，运用通用设计模式模型框架，完成试算；根节点、切量开关、营销折扣、人群标签、异常兜底等流程串联。设计这样解耦设计，极大的提到了程序的可扩展性。
    - （举例）以拼团锁单场景举例，拼团锁单场景，使用通用的责任链模型框架，校验活动的有效性（状态、有效期）和用户的参与资格。
    - （举例）以拼团结算场景举例，拼团结算场景，使用通用的责任链模型框架，校验渠道黑名单配置、拼团组队信息、交易时间属性、订单有效状态等。
    - （举例）以拼团试算场景举例，在查询优惠配置数据时候，抽象出模板结构，使用 Supplier 函数式编程，设计动态降级、缓存数据和 dao 的后置执行操作。通用模板的设计让所有场景更容易接入。`ActivityRepository#queryGroupBuyActivityDiscountVO`

  - **异步线程**，为提高用户体验，将拼团优惠试算所需的营销类数据加载，由串行改为异步线程并行执行。此执行方式由通用设计模式模型框架提供。（如果由引入星球的动态线程池，也可以在这里增加线程池的管理描述）

  - **功能方案**；

    - （举例）通过 Redis 发布订阅模型，结合 Spring AOP 切面和代理，以自定义注解的方式控制属性信息动态配置。减少系统与 Redis 的 IO 交互，提高对高频场景属性值的使用时间效率。
    - （举例）设计拼团组队结算的 HTTP、MQ 双重手段，满足外部应用和内部微服务的不同方式对接，增强系统的适配性。同时为了保证整体方案的可靠性，在结算触达时，先异步多线程方式即时触发回调（HTTP、MQ），再通过业务一致性任务数据补偿校验。（MQ、HTTP，都可能因网络原因导致失败，因此需要重试）任务的触达，还增加多分布式锁，让任务互备抢占方式执行，增强系统的鲁棒性设计。
    - （举例）设计 Redis BitSet/BitMap 人群标签，用于过滤可见和可参与，拼团活动的人群信息。该人群标签可依赖于过往用户数据（交易下单）通过 job 任务完成人群标签的录入。
    - （举例）通过策略模式，设计拼团折扣（MJ、ZJ、NYG）的计算策略。同时折扣的计算也会通过人群标签过滤，以满足运营策略配置，降低活动风险。
    - （举例）运用 retrofit2/okhttp3/spring cloud fegin + nginx 负载，对接拼团交易平台锁单服务，以及通过 http 回调和 MQ 监听来处理交易结算。
    - （举例）`三阶段实现的内容`，通过独占锁处理互备任务抢占执行回调，确保在同一时刻有一个运行的回调任务，提高系统的鲁棒性设计。
    - （举例）`三阶段实现的内容`，设计Redis无锁化拼团库存抢占和恢复库存处理，减轻数据库行锁独占的压力，提高系统吞吐量。
    - （举例）`三阶段实现的内容`，抽象通用函数式缓存分级设计，并结合扳手工程DCC动态配置，处理缓存降级到DB设计。
    - （举例）`三阶段实现的内容`，结合 RateLimiter + DCC 动态配置，实现动态限流配置。
    - （举例）`三阶段实现的内容`，以 Ai MCP + ELK + 普罗米修斯监控，以 Ai Agent 智能体方式，分析错误日志和异常监控，动态化展示监控报表。
    - （举例）`三阶段实现的内容`，通过枚举策略，设计多种类型退单（未支付&未成团、已支付&未成团、已支付&已成团），并通过回调处理退单退款。

>以上仅对部分内容做了简历编写，这里还有非常多的内容可以写到简历，可以根据自己的学习和梳理，以及扩展进行简历编写。

## 四、后端设计

### 1. 分层架构

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250803-01.png" width="950px">
</div>

- 整个系统是一个微服务分布式架构设计，通过两套系统的对接，体现微服务的全流程处理关系。
- 下面是系统中用到的核心技术栈，框架、组件、监控、部署、发布、上线，可以说是非常全面。

### 2. 工程结构

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250803-02.png" width="550px">
</div>

- 拼团和交易系统，以面向对象的思维，划分出领域结构。活动域、标签域、交易域、鉴权域、商品域、订单域。
- 两套系统通过 http/rpc(可配置对接)、mq（RabbitMQ）进行同步和异步交互，因为配有本地消息表，所以可以保证最终一致性。
- 这里有非常精妙的编码设计，如；工厂模式、组合模式、策略模式（含枚举策略）、责任链、抽象类等，又提供了 Supplier 函数式编程，可以说是应有尽有！

### 3. 库表数据

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250803-03.png" width="950px">
</div>

- 一看库表就知道，这不是小儿科！有标签表，有活动的优惠，组队，订单明细，本地消息表，商品活动配置表，sku表。

### 4. 用户旅程

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-2-25-01.png" width="700px">
</div>

- 拼团全流程简图，以用户旅程来看各个节点所做的事项。

### 5. 场景举例 - 设计模式

#### 5.1 试算

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250118-06.png" width="700px">
</div>

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-promotion-250118-03.png" width="700px">
</div>

为了解决整个交易过程的复杂场景，做了一套通用设计模式框架，并结合一套异步数据加载的多线程设计，来解决加载数据效率问题。让整个框架的灵活性非常高。

#### 5.2 退单

<div align="center">
    <img src="https://bugstack.cn/images/article/project/group-buy-market/group-buy-market-2-30-01.png" width="950px">
</div>

- 第一条退单链路，以工厂🏭方式获取执行责任链，责任链的作用是拆分原有的流程结构，分节点进行逐步处理。之后到退单的具体操作，则根据枚举策略，拿到对应执行的退单策略模式，完成退单动作。退单执行后发送MQ消息，驱动后续流程。
- 第二条消息消息，从接收 MQ 开始，以 MQ 消息中的策略类型进行库存恢复操作。这部分保持原有的走对应的策略即可。

>整套项目，每一节都会有让你有新的感受，各个章节都有亮点设计，让你可以写到简历。

